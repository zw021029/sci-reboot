# SILC-QA 智能问答系统

一个基于微信小程序的智能问答系统，包含用户管理、聊天功能等模块。
你作为一个专业的微信小程序开发工程师，请帮我开发一款小程序，叫：悉商问答系统

具体需求功能如下：

1. 功能概述
    开发一款名叫"悉商问答系统"的小程序，主要功能是：
    1. 用户可以登录小程序，并注册账号和授权信息
    2. 用户可以选择一个"机器人"（悉文或者悉荟），并与账号进行绑定
    3. 用户可以和所选择的"机器人"进行对话，用户提问，"机器人"回答
    4. 用户可以查看历史对话记录
    5. 每次对话结束后，用户可以对对话进行评价，评价结果会作为"机器人"的评价指标之一
    6. 用户每次对话会积分，系统记录并累计积分，积分可以用来兑换礼品
    7. 用户可以查看自己的积分信息和兑换记录
    8. 管理员注册登陆后，可以查看所有用户信息和对话记录、积分信息等
    9. 管理员可以对问答系统进行管理，提交问题和答案，向量化存储存入后端数据库（知识库）
    10. 针对知识库能检索到的问题，同一个问题输出的答案尽可能准确，尽可能符合知识库
    11. 针对知识库不能检索到的问题，可以采取多轮对话的方式，让"机器人"尽可能准确地回答用户的问题
    12. 悉文和悉荟的"机器人"需要有不同的回答方式，悉文需要更加男性化，悉荟需要更加女性化

2. 设计需求
    1. 小程序的UI设计需要简洁明了，符合微信小程序的规范
    2. 小程序的交互设计需要符合微信小程序的规范
    3. 小程序的动画效果需要符合微信小程序的规范
    4. 小程序的性能需要符合微信小程序的规范
    5. 小程序的兼容性需要符合微信小程序的规范
    6. 小程序的可用性需要符合微信小程序的规范
    7. 小程序的代码需要符合微信小程序的规范

3. 功能逻辑
    1. 用户登录和注册
    2. 用户选择"机器人"并进行绑定
    3. 用户和"机器人"进行对话
    4. 用户查看历史对话记录
    5. 用户对对话进行评价
    6. 用户查看积分信息和兑换记录
    7. 管理员登录和注册
    8. 管理员查看所有用户信息和对话记录、积分信息等
    9. 管理员对问答系统进行管理，提交问题和答案，或者上传知识库（pdf文件）
    10. 系统会根据知识库进行训练，并生成问答系统

4. 数据结构
    1. 用户表
    2. 机器人表
    3. 对话记录表
    4. 积分信息表
    5. 知识库表
    6. 管理员表
    7. 评价记录表
    8. 问答系统表
    9. 对话记录表
    10. 其他可能涉及到的表

5. 所有调整的备注都要写进readme.md文件中

6. 项目结构

## 项目目录结构说明

```
silc-qa/                      # 项目根目录
├── client/                   # 微信小程序前端
│   ├── api/                 # API 接口封装
│   ├── components/          # 公共组件
│   ├── pages/              # 页面文件
│   ├── utils/              # 工具函数
│   └── app.js              # 小程序入口文件
│
├── scripts/                  # 脚本文件目录
│   ├── deploy.sh           # 部署脚本
│   └── init-db.js          # 数据库初始化脚本
│
└── server/                   # 后端服务
    ├── logs/                # 日志文件目录
    │   ├── access.log      # 访问日志
    │   ├── error.log       # 错误日志
    │   └── combined.log    # 综合日志
    │
    └── src/                 # 源代码目录
        ├── api/             # API 相关文件
        │   └── routes/     # 路由定义
        │       ├── user.js # 用户相关路由
        │       └── chat.js # 聊天相关路由
        │
        ├── config/          # 配置文件目录
        │   ├── index.js    # 主配置文件
        │   └── db.js       # 数据库配置
        │
        ├── controllers/     # 控制器层
        │   ├── user.js     # 用户控制器
        │   └── chat.js     # 聊天控制器
        │
        ├── middlewares/     # 中间件
        │   ├── auth.js     # 认证中间件
        │   └── validate.js # 数据验证中间件
        │
        ├── models/          # 数据模型
        │   ├── user.js     # 用户模型
        │   └── chat.js     # 聊天模型
        │
        ├── services/        # 业务逻辑层
        │   ├── user.js     # 用户服务
        │   └── chat.js     # 聊天服务
        │
        └── utils/           # 工具函数
            ├── logger.js    # 日志工具
            └── helper.js    # 辅助函数
```

### 目录说明

1. `client/`: 微信小程序前端代码
   - 包含页面、组件、工具函数等
   - 使用微信小程序框架开发

2. `scripts/`: 项目相关脚本
   - 包含部署、数据库初始化等脚本
   - 用于自动化项目维护任务

3. `server/`: 后端服务
   - `logs/`: 日志文件存储
   - `src/`: 源代码目录
     - `api/`: API 定义和路由
     - `config/`: 配置文件
     - `controllers/`: 控制器层，处理请求和响应
     - `middlewares/`: 中间件，处理通用逻辑
     - `models/`: 数据模型定义
     - `services/`: 业务逻辑层
     - `utils/`: 工具函数和辅助方法

### 代码分层说明

1. 路由层 (Routes)
   - 定义 API 端点
   - 处理 URL 映射

2. 控制器层 (Controllers)
   - 处理 HTTP 请求
   - 调用相应的服务
   - 返回 HTTP 响应

3. 服务层 (Services)
   - 实现业务逻辑
   - 调用数据模型
   - 处理数据转换

4. 模型层 (Models)
   - 定义数据结构
   - 处理数据库操作

5. 中间件层 (Middlewares)
   - 处理认证授权
   - 验证请求数据
   - 处理错误

6. 工具层 (Utils)
   - 提供通用功能
   - 处理日志记录
   - 提供辅助方法

## 前端注意事项

在`utils/request.js`的最上方记得修改后端服务器的地址

测试数据密码为123456



## 后端部署指南

### 环境要求

- Node.js >= 14.0.0
- MongoDB >= 4.4.0
- npm >= 6.14.0

### 安装步骤

1. 克隆项目
```bash
git clone https://github.com/zw021029/silc_robot.git
cd silc-qa/server
```

2. 安装依赖

```bash
npm install
```

3. 初始化数据库

在项目根目录下执行：
```bash
mongosh < ./scripts/init-db.js
```

4. 启动服务

在server目录下执行：
```bash
# 开发环境
npm run dev

# 生产环境
npm start
```
